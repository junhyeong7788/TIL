## Problem Formulation
: 크래프트 부등식을 만족하는 코드워드 길이를 최소화하는 문제이다.

### 문제
- 목적
	- 최소화할 식
	- ![[Pasted image 20240522195504.png]]
	- 여기서 pi는 각 코드워드의 확률, li는 코드워드의 길이
	- 즉, 코드워드 길이의 기대값을 최소화하려고 한다.
- 제약조건
	- 크래프트 부등식을 만족해야한다.
	- ![[Pasted image 20240522195557.png]]

### 라그랑주 승수법(Lagrange Multipliers)
- 라그랑주 함수(Lagrangian Function)
	- 라그랑주 승수법을 사용하여 다음과 같은 라그랑주 함수를 설정
	- ![[Pasted image 20240522195808.png]]
	- 여기서 λ는 라그랑주 승수이다.
- 편미분 설정
	- 각 변수 li에 대해 편미분한 결과가 0이 되도록 설정
	- ![[Pasted image 20240522200410.png]]
	- 이를 계산하면,
	- ![[Pasted image 20240522200418.png]]
#### 라그랑주 승수법의 기본 개념
: 제약조건이 있는 최적화 문제를 풀기 위해 사용하는 방법
- 목표 : 목적함수 f(x)를 최소화하거나 최대화 하는 것이다.
- 제약조건 g(x)=0이 있는 경우 라그랑주 함수는 다음과 같이 정의 된다.
- ![[Pasted image 20240522200118.png]]

1. 첫번째 식
![[Pasted image 20240522200146.png]]

2. 두번째 식
![[Pasted image 20240522200203.png]]

- 제약조건을 단순히 시그마 D^-li로 두고, 이를 만족시키기 위한 최소화를 수행하는 경우
- 라그랑주 승수법에서 제약조건이 1인 경우, 이를 포함한 형태로 단순화하여 작성
- 두번째 식은 제약조건을 간단하게 표현하고, 그에 맞추어 라그랑주 함수의 형태를 구성한 것이다.

### 요약
- 이 과정은 크래프트 부등식을 만족하면서 코드워드 길이의 기대값을 최소화하는 최적의 코드워드 길이를 찾기 위한 방법이다.
- 라그랑주 승수법을 사용하여 제약조건을 고려한 최적화문제, 이를 통해 최적의 코드워드 길이를 구할 수 있다.

## Expected Length (최적 코드 길이)
- 어떤 확률 변수 X에 대해, 즉시 해독 가능한 D-진코드의 기대 길이 L은 다음을 만족한다.
- ![[Pasted image 20240522201527.png]]
- 여기서 H_D (X)는 D밑의 엔트로피
- 이 부등식은 D^-li = pi 일 때 성립

### 증명
1. 기대 길이와 엔트로피의 차이
- 기대 길이 L과 엔트로피 H_D(X)의 차이를 나타낼 수 있다.
- ![[Pasted image 20240522201640.png]]
- 다음으로 변형 (로그표현)
- ![[Pasted image 20240522201701.png]]

2. 새로운 변수 ri 도입
- ![[Pasted image 20240522201735.png]]
- 그리고 ![[Pasted image 20240522201749.png]]로 정의 한다.

3. 차이를 새로운 변수로 표현
- ![[Pasted image 20240522201811.png]]
- 식 정리
- ![[Pasted image 20240522201839.png]]
- 여기서 D(p||r)는 상대엔트로피를 나타낸다.

4. 상대 엔트로피의 비음수성
- D(p||r)은 항상 0이상이므로, ![[Pasted image 20240522201958.png]]
- 따라서 ![[Pasted image 20240522202009.png]] 가 성립한다.

### 요약
- 어떤 D-진 코드의 기대 길이 L이 엔트로피 ![[Pasted image 20240522202040.png]] 보다 크거나 같음을 보여준다.
- 이 부등식은 ![[Pasted image 20240522202101.png]] 일때 평등이 성립한다.
- 증명은 기대 길이와 엔트로피의 차이를 상대엔트로피와 관련된 형태로 변형하여 이 차이가 항상 0이상임을 보인다.

## D-adic Code

### 정의
- D-진 분포 (D-adic Distribution)
- 확률 분포가 D-진 분포라고 불리려면, 각 확률이 D^-n(어떤 n에 대해) 형태여야한다.
	- 예를 들어, 𝐷=2인 경우, 각 확률이 2^−1=0.5, 2^−2=0.25, 2^−3=0.125와 같은 형태가 되어야 한다.
- L = H_D(X)가 성립하려면, X의 분포가 D-진 분포여야한다.

### 최적의 코드 구성
- 구성 방법
	- 최적의 코드를 구성하기 위해서, 확률변수 X의 분포에 가장 가까운 D-진 분포를 찾아야한다.
	- 이때, 가장 가까운 분포를 찾는 기준은 상대 엔트로피를 사용한다.

- 상대 엔트로피
	- 두 확률 분포 사이의 차이를 측정하는 방법
	- p와 𝑞라는 두 분포가 있을 때, 상대 엔트로피 𝐷(𝑝∥𝑞)는 𝑝가 𝑞로부터 얼마나 벗어나 있는지를 나타낸다.
	- ![[Pasted image 20240522202800.png]]

### 구현의 어려움과 대안 탐색
- 가장 가까운 D-진 분포를 찾는 것은 쉽지 않은 작업이다.
- 따라서, 이 과정에서는 다양한 대안을 탐색할 필요가 있다.

