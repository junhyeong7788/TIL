# 군집 알고리즘

## 군집 분석의 개념 및 활용 > 군집분석
: 주어진 데이터에서 구조와 패턴을 찾아 유사한 개체를 그룹화하는 프로세스

### 군집 분석 유형
- 하드 클러스터링
	- 개체는 하나의 군집에만 속함
- 소프트 클러스터링
	- 개체는 하나 이상의 클러스터에 속할 수 있음

### 군집분석이 필요한 TASK
1. 머신러닝 과정에서 학습데이터의 구조적 이해
   - EDA (Exploratory Data Analysis) : 수집한 데이터를 다양한 각도에서 관찰하고 이해, 그래프나 통계적인 방법으로 지표를 직관적으로 바라보는 과정
   
2. 새로운 데이터의 분류
   
3. 비정상적인 행위 탐지
   - 알려진 군집들 이외에 속하는 사용패턴을 식별, 컴퓨터 네트워크에 비인가된 침입 판별

4. 대량 데이터셋을 소수의 **균일한 범주로 단순화** (쉽게 접근 가능)
   - 유사한 값을 가진 속성을 그룹화, 작은 그룹으로 구매 행위에 대해 구체적으로 분석하거나 유사한 통계나 마케팅 행사를 위한 구매 패턴으로 고객을 구분

### 군집분석 활용사례

초등돌봄 수요예측 모델개발 프로세스
![[Pasted image 20240227161007.png]]


MRI Image segmentation
- 수술 계획 수립 및 이상 감지를 위한 의료 응용 프로그램에서 핵심 작업
- 각 픽셀의 위치 및 값의 변환을 통해 특징 벡터 세트를 도출하고, 여러 구조로 그룹화하여 해부학적으로 의미 있는 영역으로 구분

마케팅
1. 시장 세분화 - 신제품 계획 및 개발
2. 고객 그룹화 - SNS에서 유사한 행동을 보이는 사람들을 클러스터링
3. 쇼핑 항목 그룹화 - 시장조사에서 고객 주문을 분석 및 예측하고 개별 요구 사항에 따라 서비스를 제공 후 도움

## 유사성 판별 방법
유사성
- 가장 유사한 데이터 포인트를 동일한 클러스터로 구성
- 클러스터 간의 유사도는 최대한 차별화 되도록 구성

데이터 간의 '거리'를 사용
- 거리가 짧은 두 데이터 : 유사성 높음
- 거리가 먼 두 데이터 : 유사성 낮음

거리 측정 방법
- 유클리디안 거리 (Euclidean distance)
	- 두 객체의 직선거리를 구하는 방법

---
# 계층적 군집 알고리즘
- 군집 생성 기술에 따라 군집 생성 결과는 다르다.
- 상향식 또는 하양식 접근 방식중 하나를 사용
	- 통합 계층적 군집
		- 단일 개체 -> 더 큰 클러스터로 병합
		- 상향식 접근
	- 분할 계층적 군집
		- 모든 개체 전체 -> 작은 클러스터로 분할
		- 하양식 접근


## 클러스터간 거리 측정 방법
- 유클리드 거리
- 맨하튼 거리 : 데이터의 분포가 희소벡터(원소 대부분이 0인 백터)인 경우 , 맨하튼 거리(x, y축 정보에 따른 거리) 사용 
  
- 최단(단일) 연결법 : 각 클러스터에서 가장 가까운 요소를 뽑아 연결한 거리로 군집 간 거리 측정 
- 최장(완전) 연결법 : 각 클러스터에서 한 점을 뽑아 연결할 수 있는 가장 최장거리를 군집 간 거리로 판단
- 중심 연결법 : 두 군집 중심간의 거리
- 평균 연결법 : 첫번째 군집의 구성원과 두번째 군집의 구성원 사이의 거리를 평균하여 계산
- 와드 연결법 : 모든 군집 내에서 차이 제곱의 합을 최소화

## 덴드로그램
### 거리 행렬
- 데이터 간 거리를 나타내는 행렬
	- 가장 짧은 거리를 갖는 두 데이터를 클러스터로 지정 : a와 d간의 거리가 3으로 가장 짧으므로 클러스터로 지정
	  
- 클러스터 간 거리 계산
	-  클러스터 ad의 중심을 계산하고, 이 중심을 클러스터 ad의 위치로 사용
		- 최단 연결, 최장 연결, 평균 연결, 중심 연결 등
	- 최단 연결 
		- a에서 b까지의 원래 거리 : 12
		- d에서 b까지의 원래 거리 : 8
		- ad에서 b까지의 거리 : 8
	- {ad, b, c, e, f} -> {adf, b, c, e} -> {adf, b, ce} -> {adfce, b}
	- 최종 덴드로그램으로 표현
		- 나무를 나타내는 다이어그램 (군집들의 계층구조  도식화)
- 덴드로그램을 사용해 계층적 군집을 생성하는 과정
	- 덴드로그램 생성
	- 군집 개수 선정 (수평선을 지나는 군집 개수 카운트)
	- 적절한 군집 수 선정

# 마무리
계층적 군집 알고리즘은 데이터의 수가 많을 때 적합하지 않음

---
# 군집 알고리즘 평가방법

- 좋은 클러스터 알고리즘 이란?
	- 클래스 내 유사성이 높고 클래스 간 유사성이 낮은  클러스터를 만들 수록 좋음
	- 군집 알고리즘에 따라 품질 달라짐
### 목적변수가 있는 경우
- 군집의 실제값 존재 -> 정확 평가 가능

```ad-note
Homogeneity
	- 각 군집들이 각 범주의 데이터만 포함하는지 여부
	- 0.0 ~ 0.1까지 (1.0 : 좋은 성능)
```

```ad-note
Completeness
	- 주어진 범주의 데이터가 같은 군집 내에 있는 지 여부
```

```ad-note
V-measure
	- Homogeneity 와 Completeness의 조화평균
	- 조화평균 : 주어진 수들의 역수의 산술평균의 역수
```

### 목적변수가 없는 경우
- 실루엣 분석 (Silhouette analysis)
	- 각 군집 간의 거리가 얼마나 효율적으로 분리되어 있는지 나타냄
- 실루엣 계수 (Silhouette coefficient)
	- 해당 데이터가 같은 군집 내의 데이터와 얼마나 가깝게, 다른 군집에 있는 데이터와는 얼마나 멀리 분리 되어 있는지 나타내는 지표
	- 실루엣 계수의 평균값은 0~1사이, 1에 가까울수록 좋음
-  전체 실루엣 계수의 평균값과 더불어 개별 군집의 평균값의 편차가 크지 않아야 함

```
a = 클러스터 내 위치한 각 점들 간의 거리 평균
b = 모든 클러스터간 평균 거리
```

### 군집 생성을 위한 속성
- 클러스터를 구별하기 위한 대표값
	- Centroids ( 중심점 )
	- Medoids ( 중앙점 )
	- Representative points ( 대표점 )

