# 독립 ( Independent )

- $P(X \cap Y) = P(X)P(Y)$

= P(X)P(Y)인 경우, 두사건 X와 Y는 서로 독립이다 (필요충분조건)

- 두 변수가 서로 영향을 주지 않는다는 의미
- 예를 들어 로또 1등 당첨확률은 항상 1/8,145,060 이다.
- ex) 1. 첫번째 자동 로또가 당첨되는 사건과 2. 두번째 자동 로또가 1등에 당첨되는 사건
  - 1,2 -> 두 사건 모두 8백만분의 1 = 독립사건

```
1. 내일 내가 수학 쪽지 시험에서 100점 맞는 사건
2. 내일 샌프란시스코에 비가 오는 사건
-> 두사건의 연관성은 없다. 즉, 독립사건이다.
```

# 종속 ( Dependent )

- 두사건 X와 Y가 있다고 가정하자
- 한사건의 결과가 다른 사건에 영향을 줄 때 X와 Y를 종속 사건이라고 한다.
- (상관관계) 일반적으로 수학성적이 높으면 영어성적도 높다.
  - 1.  수학을 100점 맞는 사건
  - 2.  영어를 100점 맞는 사건

# 배반 사건

: "교집합이 없는 " 사건을 의미

- 1. 나의 수학성적이 50점이상인 사건
- 2. 나의 수학성적이 50점 미만이 사건

# 배반 vs 독립

- 독립사건에서 P(Y|X) = P(Y)의 의미 - "사건 X의 발생 여부와 상관없이, 사건 Y가 발생할 확률은 동일하다"
  ![[Pasted image 20240312174734.png]]

# 다변수 확률 변수 ( Multivariable Random Variable )

: 확률변수가 두개 이상 있는 경우

- 개별적인 확률변수에 대한 확률분포를 고려할 수 있다.
- 두 확률변수를 모두 고려한 "복합적인" 확률분포를 계산할 수 있다.

- 딥러닝 분야 분포는 일반적으로 다변수 확률 분포(변수가 여러 개)에 해당

# 결합 확률 ( Joint Probability )

: 두 개의 사건이 **동시에** 일어날 확률로, 두 확률 변수의 **교집합**이 발생할 확률이다.

- 마찬가지로 확률은 항상 0과 1사이의 값을 가진다
- P(X,Y) 혹은 P는 X와 Y의 교집합 형태로 표현한다.

# 결합 확률 함수 ( Joint Probability Function)

: 이산확률 변수 X, Y에 대한 결합확률 함수란 무엇일까?

- $P(X=x_{i},Y=y_{j})$ = $f_{XY}(x_{i},y_{j})$

- 결과적으로 단순히 f(x,y)라고 쓰기도 한다. (X,Y의 결합확률분포)
- X와 Y가 가진 범위에서 결합확률함수의 값을 모두 더하면 1이다.

### 결합 확률 질량 함수 예시

- 랜덤으로 1부터 9까지의 수 중에서 하나를 출력하는 기계
- 한 번 동작 시켰다고 가정

1. 얻은 수가 짝수이면 X=0, 홀수 X=1
2. 얻은 수가 소수가 아니면 Y = 0, 소수이면 Y = 1

- 얻을 수 있는 수에 따른 X와 Y의 값을 확인

```
결합확률 함수는 아래와 같다.
- f(0,0) = 3/9
- f(0,1) = 1/9
- f(1,0) = 2/9
- f(1,1) = 3/9
```

- 결합 확률 질량 함수는 모든 확률 값을 더 했을 때 1이다.

```
- 이산확률변수가 두개 이상인 확률 질량함수.
- 전체 학생 수가 30명 일때, 수학이 1등급이면서 영어가 2등급인 학생이 1명 있다면?
- P_{XY}(1,2) = P(X=1, Y=2)= 1/30
```

### 파이썬 예시

- 결합 확률 질량 함수 구하기

```python
import pandas as pd

scores = [1, 2, 3, 4, 5] # array
data = [
    [2, 1, 0, 0, 0],
    [1, 3, 4, 0, 0],
    [1, 3, 5, 2, 0],
    [0, 0, 0, 3, 2],
    [0, 0, 0, 1, 2]
] # 5X5, 2차원 리스트

# 행(index)과 열(columns) 모두 값으로 [1, 2, 3, 4, 5]를 가진다.
df = pd.DataFrame(data, index=scores, columns=scores)
df.columns.name = "X"
df.index.name = "Y"

#df.values : 데이터프레임 값들을 Numpy배열로 가져온다 / 각 값을 데이터프레임 값들의 합으로 나누어 PMF를 계산
pmf = df / df.values.sum()
print(pmf)
```

-> 각 값을 데이터프레임 값들의 합으로 나누어 PMF를 계산

- 히트맵 그리기

```python
import matplotlib.pyplot as plt
import seaborn as sns


sns.set(font_scale=1.5) # 그림(figure)의 기본적인 폰트(font) 크기 설정
plt.rcParams["figure.figsize"] = [10, 8]
# 히트맵(heatmap) 그리기
ax = sns.heatmap(pmf, annot=True,
    xticklabels=[1, 2, 3, 4, 5],
    yticklabels=[1, 2, 3, 4, 5]
)
plt.title("Heatmap", fontsize=20) # 그림(figure)의 제목(title) 설정
plt.show()
```

-> 위 에서 구한 PMF의 히트맵을 그린 코드

# 주변 확률 질량 함수 ( Marginal Probability Mass Function )

- 두 확률 변수 중에서 하나의 확률변수에 대해서만 확률분포를 나타낸 함수
- $P_{X}(X)= \sum{y_{i}}P_{XY}(x,y_{i})$
- $P_{Y}(Y)= \sum{x_{i}}P_{XY}(x_{i},y)$

- 예를 들어 수학 등급이 1등급일 확률은 아래와 같다.
- $P*{X}(1) = P*{XY}(1,1) + P*{XY}(1,2) + P*{XY}(1,3) + P*{XY}(1,4) + P*{XY}(1,5)$
- 즉, X = 1로 고정, 모든 Y변수에 대하여 확률 값을 더한 것
- 이를 모든 X에 대하여 표현하면, 주변 확률 질량 함수 가 된다.

```python
index = 0
x = [0, 1, 2, 3, 4]
plt.bar(x, pmf.iloc[index])
plt.xticks(x, ["1", "2", "3", "4", "5"])
plt.title(f"P(X, Y={index + 1})")
plt.show()

# 각 열마다 합계 계산
marginal_pmf_x = pmf.sum(axis=0) # 행렬의 각 열을 합산하여 X축 주변 확률 계산
print(marginal_pmf_x)

# 각 행마다 합계 계산
marginal_pmf_y = pmf.sum(axis=1) # 행렬의 각 행을 합산하여 Y축 주변 확률 계산
print(marginal_pmf_y)
```

- 파이썬 함수를 사용하여 계산한 것, 간단한 코드이다.
