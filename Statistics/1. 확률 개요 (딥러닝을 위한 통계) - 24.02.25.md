# 확률 (Probability) 이란?
- 확률 : 특정한 사건이 일어날 가능성을 수로 표현한 것
- 0부터 1(100%) 사이의 실수로 표현

### 확률이 사용되는 예시
- 스팸 메일 분류 모델
	- 도착 메일 총 1000개, 이 중 700개는 스팸 메일, 300개는 정상 메일.
	- 새롭게 하나의 메일이 도착, 그것이 스팸 메일일 확률은 얼마일까?
-> 데이터를 토대로 향후 사건의 기대값 예측가능
- 이 메일은 7/10의 확률로 스팸메일

# 기계학습 모델을 확률적으로 이해하기
- N개의 학습데이터로 기계학습 모델을 학습
- 일반적으로 기계학습 모델의 출력은 "확률"형태를 띤다.

```ad-example
예시 1. 이미지 분류 모델이 이미지 x에 대해서 75% 확률로 고양이 일 것이라고 예측
예시 2. 글쓰기 모델이 "나는 밥을" 이후에 "먹었다"라는 단어가 나올 확률을 42%로 예측
```

# 경우의 수 
- 다양한 문제 상황에서의 확률 계산
- 이를 위해 기본적으로 경우의 수를 계산하는 방법을 알아야한다.
- 순열과 조합이 있다.

# 순열 ( Permutation)
- 서로 다른 𝑛개에서 𝑟개를 중복 없이 뽑아 *특정한 순서*로 나열하는 것을 의미
### 순열 예시 - 학습에 사용할 이미지 순서
- 기계 학습 모델 학습을 위해 N개의 학습데이터로 학습을 진행,
- 이때 매번(epoch)모델에 학습 데이터를 넣을 순서를 섞어서 (shuffling)학습을 진행

`에포크(epoch) : 학습데이터 세트에 포함된 모든 데이터가 한 번씩 모델을 통과한 횟수를 말함`

```python
from itertools import permutations

arr = ['A', 'B', 'C']
# 원소 중에서 2개를 뽑는 모든 순열 계산
result = list(permutations(arr, 2))
print(result)
```

# 조합 (Combination)
- 서로 다른 𝑛개에서 𝑟개를 중복 없이 *순서를 고려하지 않고* 뽑는 것을 의미

### 조합 예시 - 샴 네트워크
- 딥러닝 아키텍처 중 하나
- 두 개의 이미지를 받아서, 두 이미지가 유사하다면 1을 , 다르다면 0을 출력
- N개의 이미지로 구성된 데이터 세트가 있을 때, 매번 2개의 이미지를 뽑아서 2개의 이미지를 네트워크의 입력으로 넣는다. 이 경우, 두 이미지에 대하여 순서는 상관없다.

```python
from itertools import combinations

arr = ['A', 'B', 'C']
# 원소 중에서 2개를 뽑는 모든 조합 계산
result = list(combinations(arr, 2))
print(result)
```

# 중복 순열 (Permutation with Repetition)
: 서로 다른 𝑛개에서 중복을 포함해 𝑟개를 뽑아 특정한 순서로 나열하는 것을 의미

### 중복 순열 예시
- 세 개의 숫자 1,2,3을 이용해 만들 수 있는 두 자리 자연수의 개수는?
- (단, 같은 숫자를 여러 번 사용하거나, 사용하지 않는 숫자가 있어도 괜찮다.)

```python
from itertools import product

arr = ['A', 'B', 'C']
# 원소 중에서 2개를 뽑는 모든 중복 순열 계산
result = list(product(arr, repeat=2))
print(result)
```
# 중복 조합 (Combination with Repetition)
: 서로 다른 𝑛개에서 중복을 포함해 순서를 고려하지 않고 𝑟개를 뽑는 것을 의미

### 중복 조합 예시
: 딥러닝에서는 학습된 여러 모델의 결과를 활용하여 최종적인 결과를 생성하는 앙상블(ensemble)방법이 존재
`ensemble : 여러 단일 예측 (or 분류) 모델을 하나로 엮어 더 좋은 성능의 복합모델을 만드는 기법`

```python
from itertools import combinations_with_replacement

arr = ['A', 'B', 'C']
# 원소 중에서 2개를 뽑는 모든 중복 조합 계산
result = list(combinations_with_replacement(arr, 2))
print(result)
```

- 서로 다른 딥러닝 아키텍처 1번, 2번, 3번이 존재
- 중복을 허용하여 4개를 골라서 딥러닝 모델 4개를 학습하고자 한다.
- (문제) 이때 가능한 학습의 모든 조합의 수는?
	- 같은 아키텍처를 여러 번 사용하거나, 선택하지 않는 아키텍처가 있어도 된다.
- 예시) 학습할 4개의 모델을 `[1,2,3,1]`로 선택가능
	- 1번 아키텍처만 4개 학습하여, `[1,1,1,1]`도 가능
	- 학습 순서는 상관 없기 때문에 `[1,2,3,1]`과 `[1,2,1,3]`은 같은 경우에 속함

# 확률
: S를 전체 사건의 집합이라고 하자.
- 사건 X가 일어날 확률 P(X)는 ?
	- P(X) = 사건 X가 일어나는 경우의 수 / 전체 경우의 수 = n(X)/n(S)
	- 앞면에 1, 뒷면에 0이 쓰여 있는 2개의 동전을 2번 던졌을 때, 눈금의 합이 1일 확률은?

# 통계적 확률
- 주사위를 던졌을 때 눈금이 5가 나올 확률은 1/6이다.
- 그렇다면, 6번 던졌을 때, 반드시 눈금이 5인 경우가 나올까?
	- 시행횟수가 적기 때문에 장담 할 수 없다.
	- 하지만 6,000번 던졌다면 1,000번에 가까운 횟수로 등장할 것이다. (데이터의 중요성)

# 마무리
확률의 개요와 경우의 수로 존재하는 방법인 순열과 조합에 대해 배울 수 있었고, 
간단한 파이썬 구현 코드로 살펴볼 수 있었다.


