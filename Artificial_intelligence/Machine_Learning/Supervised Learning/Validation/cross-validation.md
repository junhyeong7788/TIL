# π€ ν•™μµ ν‚¤μ›λ“

- κ³Όμ ν•© (overfitting) : λ¨λΈμ΄ ν•™μµλ°μ΄ν„°μ—λ§ κ³Όλ„ν•κ² μµμ ν™”λμ–΄, μ‹¤μ  μμΈ΅μ„ λ‹¤λ¥Έ λ°μ΄ν„°λ΅ μν–‰ν•  κ²½μ°μ—λ” μμΈ΅ μ„±λ¥μ΄ κ³Όλ„ν•κ² λ–¨μ–΄μ§€λ” κ²ƒ
- λ°μ΄ν„°λ” μ΄μƒμΉ, λ¶„ν¬λ„, λ‹¤μ–‘ν• μ†μ„±κ°’, ν”Όμ² μ¤‘μ”λ„ λ“± μ—¬λ¬κ°€μ§€ MLμ— μν–¥μ„ λ―ΈμΉλ” μ”μ†λ¥Ό κ°€μ§€κ³  μλ‹¤.
- νΉμ • ML μ•κ³ λ¦¬μ¦μ—μ„ μµμ μΌλ΅ λ™μ‘ν•  μ μλ„λ΅ λ°μ΄ν„°λ¥Ό μ„ λ³„ν•΄ ν•™μµν•λ‹¤λ©΄ μ‹¤μ  λ°μ΄ν„° μ–‘μ‹κ³Όλ” λ§μ€ μ°¨μ΄κ°€ μμ„ κ²ƒμ΄λ‹¤ => μ„±λ¥μ €ν•

## μ •μ

- `κµμ°¨ κ²€μ¦ (cross-validation)` : λ°μ΄ν„° νΈμ¤‘μ„ λ§‰κΈ° μ„ν•΄ λ³„λ΅ μ—¬λ¬ μ„ΈνΈλ΅ κµ¬μ„±λ ν•™μµ λ°μ΄ν„° μ„ΈνΈμ™€ κ²€μ¦ λ°μ΄ν„° μ„ΈνΈμ—μ„ ν•™μµκ³Ό ν‰κ°€λ¥Ό μν–‰ν•λ” κ²ƒ
  - λ€λ¶€λ¶„μ ML λ¨λΈμ μ„±λ¥ ν‰κ°€λ” κµμ°¨ κ²€μ¦ κΈ°λ°(`ν•™μµλ°μ΄ν„°λ¥Ό ν•™μµκ³Ό κ²€μ¦λ°μ΄ν„°λ΅ λ‚λ μ„`)μΌλ΅ 1μ°¨ ν‰κ°€λ¥Ό ν• λ’¤μ— μµμΆ…μ μΌλ΅ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈμ— μ μ©ν•΄ ν‰κ°€ν•λ” ν”„λ΅μ„Έμ¤
  - MLμ— μ‚¬μ©λλ” λ°μ΄ν„° μ„ΈνΈλ¥Ό μ„Έλ¶„ν™”ν•΄μ„ ν•™μµ, κ²€μ¦, ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ΅ λ‚λ”

## ν‚¤μ›λ“

`κµμ°¨ κ²€μ¦ (Cross Validation): λ¨λΈμ μΌλ°ν™” μ„±λ¥μ„ λ†’μ΄κΈ° μ„ν•΄ ν•™μµ λ°μ΄ν„°λ¥Ό μ—¬λ¬ μ„ΈνΈλ΅ λ‚λ„μ–΄ λ°λ³µ ν‰κ°€ν•λ” κΈ°λ²•μΌλ΅, K-fold, LOOCV, Shuffle Split λ“± λ‹¤μ–‘ν• λ°©μ‹μ΄ μμΌλ©°, μ—°μ‚° λΉ„μ©μ΄ λ†’μ€ λ€μ‹  λ°μ΄ν„° νΈμ¤‘μ„ λ°©μ§€ν•μ—¬ μ •ν™•ν• μ„±λ¥ ν‰κ°€κ°€ κ°€λ¥ν•λ‹¤.`

---

# π“μƒλ΅ λ°°μ΄ κ°λ…

## κµμ°¨ κ²€μ¦ λ°©λ²•μ μΆ…λ¥

- `K-fold κµμ°¨ κ²€μ¦`
  - Kκ°μ ν΄λ“ μ„ΈνΈλ¥Ό λ§λ“¤μ–΄μ„ kλ²μ ν•™μµκ³Ό κ²€μ¦μ„ λ§μΉκ³ , κ° κ²€μ¦ ν‰κ°€μ ν‰κ· μ„ λ‚Έ κ²ƒμΈ μµμΆ… κ²€μ¦ ν‰κ°€
  - 1.  μμ„λ€λ΅ λ‚μ—΄λ λ μ΄λΈ”μ— μ μ”ν• κµμ°¨κ²€μ¦ (k-fold)
  - 2.  ν΄λμ¤μ λ¶„ν¬ λΉ„μ¨μ— λ§κ² ν΄λ“λ¥Ό λ§λ“λ” κµμ°¨ κ²€μ¦ (stratified k-fold)
- `LOOCV (Leave-one-out Cross-validation)` : ν΄λ“ ν•λ‚μ— μƒν” ν•λ‚λ§ λ“¤μ–΄μλ” k-κ²Ή κµμ°¨ κ²€μ¦
  - μ΄ N(μƒν” μ)λ²μ λ¨λΈμ„ λ§λ“¤κ³ , κ° λ¨λΈμ„ λ§λ“¤ λ• μ „μ²΄ train datasetμ¤‘μ— ν•λ‚λ§μ λ°μ΄ν„°λ§ validation datasetμΌλ΅ λ‘κ³ , λ‚λ¨Έμ§€λ” λ¨λ‘ train datasetμΌλ΅ μ‚¬μ©
- `μ„μ λ¶„ν•  κµμ°¨ κ²€μ¦(shuffle split)` : train_sizeλ§νΌμ ν¬μΈνΈλ΅ ν›λ ¨ μ„ΈνΈλ¥Ό λ§λ“¤κ³ , test_sizeλ§νΌμ (train datasetκ³Ό μ¤‘μ²©λμ§€ μ•λ”)ν¬μΈνΈλ΅ ν…μ¤νΈ μ„ΈνΈλ¥Ό λ§λ“¤λ„λ΅ λ¶„ν• ν•λ‹¤.
- `κ·Έλ£Ήλ³„ κµμ°¨ κ²€μ¦(Group K-fold)` : λ°μ΄ν„° μ•μ— λ§¤μ° μ—°κ΄€λ κ·Έλ£Ήμ΄ μμ„ λ• κ·Έλ£Ήλ³„ κµμ°¨κ²€μ¦μ„ μ‚¬μ©
- `λ°λ³µ κµμ°¨ κ²€μ¦(Repeated Stratified K-fold)` : cross_val_scoreν•¨μμ cvλ§¤κ°λ³€μμ— μ „λ‹¬ν•μ—¬ κµμ°¨ κ²€μ¦μ„ λ°λ³µν•  μ μλ‹¤. λ°λ³µν•  λ•λ§λ‹¤ μ„λ΅ λ‹¤λ¥Έ λ¶„ν• μ΄ μƒμ„±λλ‹¤λ” κ²ƒμ΄ νΉμ§•

### κµμ°¨ κ²€μ¦μ μ¥λ‹¨μ 

- μ¥μ 
  - λ¨λΈμ μΌλ°ν™”λ¥Ό ν‰κ°€ν•κΈ° μ„ν•΄ test dataλ΅ μ •ν™•λ„ ν‰κ°€λ΅ μ‚¬μ©ν•λ”λ° `λ¶„λ¥ν•κΈ° μ–΄λ ¤μ΄ μƒν”λ“¤`μ΄ λ¨λ‘ ν…μ¤νΈ λ°μ΄ν„°λ΅ λ“¤μ–΄κ°„λ‹¤λ©΄ κ·Έ λ¨λΈμ μ •ν™•λ„λ” λ–¨μ–΄μ§„λ‹¤
  - μ„ κ²½μ°λ¥Ό λ§‰κΈ° μ„ν•΄ κµμ°¨ κ²€μ¦ λ°©λ²•μ„ μ‚¬μ©ν•λ©΄ μ μ–΄λ„ λ¨λ“  μƒν” λ°μ΄ν„°λ” ν΄λ“ μ¤‘ ν•λ‚μ— μ†ν•κ³ , ν• λ²μ”© ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈκ°€ λκΈ° λ•λ¬Έμ— μΌλ°ν™”λ¥Ό ν‰κ°€ν•κΈ° μΆ‹λ‹¤.
  - κ° ν΄λ“λ³„λ΅ μ •ν™•λ„μ ν‰κ· μ„ κµ¬ν•λ” κ²ƒμ΄κΈ° λ•λ¬Έμ— κ²°κµ­ ν…μ¤νΈ μ…‹μ— μλ” λ¨λ“  μƒν”μ— λ€ν•΄ λ¨λΈμ΄ μ μΌλ°ν™”λμ–΄μ•Όν•λ‹¤.
- λ‹¨μ  : ν•λ²μ κ²€μ¦λ§ κ±°μ³μ„ ν‰κ°€ν•λ” κ²ƒμ΄ μ•„λ‹λΌ μ—¬λ¬ λ² κ²€μ¦μ„ ν•λ©° μ „μ²΄ ν‰κ· μ„ λ‚΄λ” κ²ƒμ΄κΈ° λ•λ¬Έμ— μ—°μ‚° λΉ„μ©μ΄ λμ–΄λ‚λ‹¤λ” λ‹¨μ 

## κµμ°¨κ²€μ¦ κ°„νΈν•κ² - cross_val_score()

- `cross_val_score()` : μ„μ κ³Όμ •μ„ ν•κΊΌλ²μ— μν–‰ν•΄μ£Όλ” API
- APIμ μ„ μ–Έν•νƒ : `cross_val_score(estimator, X, y=None, scoring=None, cv=None, n_jobs=1, verbose=0, fit_params=None, pre_dispatch='2*n_jobs')`
  - estimator : μ‚¬μ΄ν‚·λ°μ λ¶„λ¥ μ•κ³ λ¦¬μ¦ ν΄λμ¤μΈ Classifier λλ” νκ·€ μ•κ³ λ¦¬μ¦ ν΄λμ¤μΈ Regressor
  - X : ν”Όμ² λ°μ΄ν„° μ„ΈνΈ
  - y : λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ
  - scoring : μμΈ΅ μ„±λ¥ ν‰κ°€ μ§€ν‘
  - cv : κµμ°¨ κ²€μ¦ ν΄λ“ μ
  - λ°ν™κ°’ : scoring νλΌλ―Έν„°λ΅ μ§€μ •λ μ„±λ¥ μ§€ν‘ μΈ΅μ •κ°’μ„ λ°°μ—΄ ν•νƒλ΅ λ°ν™

```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import cross_val_score , cross_validate
from sklearn.datasets import load_iris

iris_data = load_iris()
dt_clf = DecisionTreeClassifier(random_state=156)

data = iris_data.data
label = iris_data.target

# μ„±λ¥ μ§€ν‘λ” μ •ν™•λ„(accuracy) , κµμ°¨ κ²€μ¦ μ„ΈνΈλ” 3κ°
scores = cross_val_score(dt_clf , data , label , scoring='accuracy',cv=3)
print('κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„:',np.round(scores, 4))
print('ν‰κ·  κ²€μ¦ μ •ν™•λ„:', np.round(np.mean(scores), 4))
```

- `cross_val_score()`λ” cvλ΅ μ§€μ •λ νμλ§νΌ `scoring` νλΌλ―Έν„°λ΅ μ§€μ •λ ν‰κ°€ μ§€ν‘λ΅ ν‰κ°€ κ²°κ³Όκ°’μ„ λ°°μ—΄λ΅ λ°ν™
- μΌλ°μ μΌλ΅ `cross_val_score()`λ” ν‰κ°€ κ²°κ³Όκ°’μ ν‰κ· μ„ ν‰κ°€ μμΉλ΅ μ‚¬μ©
  - μ½”λ“λ¥Ό μν–‰ν• μμ μ™€ Stratified KFoldκ°€ κ° κµμ°¨ κ²€μ¦λ³„ μ •ν™•λ„μ™€ ν‰κ·  κ²€μ¦ μ •ν™•λ„κ°€ λ¨λ‘ λ™μΌ (= λ‚΄λ¶€μ μΌλ΅` Stratified KFold`λ¥Ό μ΄μ©ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.)

---

# β¨

- κµμ°¨ κ²€μ¦ λ°©λ²•μ μΆ…λ¥, κµμ°¨ κ²€μ¦μ μ¥λ‹¨μ , cross_val_score()
- κµμ°¨κ²€μ¦μ€ λ°μ΄ν„°νΈμ¤‘μ„ λ°©μ§€ν•μ—¬ μ •ν™•ν• μ„±λ¥ν‰κ°€κ°€ κ°€λ¥ν•λ‹¤.

---

# π”—λ νΌλ°μ¤

## μ°Έκ³  κ°•μ/κΈ€

- [### κµμ°¨ κ²€μ¦(Cross Validation)μ΄λ€? κµμ°¨ κ²€μ¦μ μΆ…λ¥ λ° μ‚¬μ©λ²•](https://day-to-day.tistory.com/32)
- [TIL K-Fold, StratifiedKFold.md](https://github.com/junhyeong7788/TIL/blob/77b3e6ca41efbf56d47549a7da56cf49920530c6/Python/Scikit-Learn/K-Fold%2C%20StratifiedKFold.md)
